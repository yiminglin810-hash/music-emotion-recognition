# ðŸ“¦ Datasets for Music Emotion Recognition

This directory contains **processed features and annotations** for three MER datasets. **Raw audio files are NOT included** in this repository due to size and copyright restrictions.

---

## ðŸ—‚ï¸ Directory Structure

```
data/
â”œâ”€â”€ README.md                           # This file
â”‚
â”œâ”€â”€ DEAM/                               # MediaEval DEAM Dataset
â”‚   â”œâ”€â”€ DEAM_audio/                     # âŒ Download separately (1,802 MP3s, ~3GB)
â”‚   â”œâ”€â”€ DEAM_Annotations/               # âŒ Download separately (3,610 CSVs)
â”‚   â”œâ”€â”€ features/                       # âœ… Generated by notebooks (1,802 CSVs)
â”‚   â””â”€â”€ processed/                      # âœ… Generated by notebooks
â”‚       â”œâ”€â”€ deam_features.csv           # Aggregated features (1,802 songs)
â”‚       â””â”€â”€ deam_annotations_static.csv # Static V-A annotations
â”‚
â”œâ”€â”€ MuSe/                               # MuSe 2021 Dataset
â”‚   â”œâ”€â”€ audio_clips_1000/               # âŒ Download separately (960 MP3s, ~2GB)
â”‚   â”œâ”€â”€ muse_v3.csv                     # âŒ Download separately (annotations)
â”‚   â”œâ”€â”€ features/                       # âœ… Generated by notebooks
â”‚   â””â”€â”€ processed/                      # âœ… Generated by notebooks
â”‚       â”œâ”€â”€ muse_features_133dim.csv    # Aggregated features (90,001 clips)
â”‚       â””â”€â”€ muse_annotations.csv        # Processed annotations
â”‚
â””â”€â”€ PMEmo2019/                          # PMEmo Dataset
    â”œâ”€â”€ PMEmo2019/                      # âŒ Download separately (794 MP3s + annotations, ~1.5GB)
    â”‚   â”œâ”€â”€ chorus/                     # 794 MP3 files (30s chorus segments)
    â”‚   â”œâ”€â”€ annotations/                # Static annotations (CSV)
    â”‚   â””â”€â”€ annotations_time_continuous/# Dynamic annotations (CSV)
    â””â”€â”€ processed/                      # âœ… Generated by notebooks
        â””â”€â”€ pmemo_features_rich.csv     # Aggregated features (794 songs)
```

**Legend:**
- âŒ = Not tracked in Git (too large or copyrighted)
- âœ… = Generated by notebooks (tracked in Git if small)

---

## ðŸ“¥ Download Instructions

### 1ï¸âƒ£ DEAM Dataset

**Source**: MediaEval Database for Emotional Analysis in Music  
**Link**: https://cvml.unige.ch/databases/DEAM/

**Steps:**
1. Visit the link and fill out the request form
2. Download two ZIP files:
   - `DEAM_audio.zip` (~3 GB, 1,802 MP3s)
   - `DEAM_Annotations.zip` (~10 MB, 3,610 CSVs)
3. Extract to:
   ```
   Semester1/data/DEAM/DEAM_audio/
   Semester1/data/DEAM/DEAM_Annotations/
   ```

**Verification:**
```bash
cd Semester1
python verify_deam.py
```

Expected output:
```
âœ… Found 1802 audio files
âœ… Found 3610 annotation files
âœ… DEAM dataset is ready!
```

---

### 2ï¸âƒ£ MuSe Dataset

**Source**: MuSe 2021 Challenge (Multimodal Stressed Emotion)  
**Link**: https://zenodo.org/record/5090631

**Steps:**
1. Download `muse_v3.csv` (annotations, ~50 MB)
2. Download `audio_clips.zip` (960 MP3s, ~2 GB)
   - **Note**: Only 960 out of 90,001 clips are publicly available
   - We use Spotify API to download the remaining clips (see `scripts/download_muse_spotify.py`)
3. Extract to:
   ```
   Semester1/data/MuSe/audio_clips_1000/
   Semester1/data/MuSe/muse_v3.csv
   ```

**Alternative (Spotify API)**:
```bash
# Install Spotify credentials
# See docs/68_Spotify_APIä¸‹è½½æŒ‡å—.md

# Run download script
python scripts/download_muse_spotify.py
```

---

### 3ï¸âƒ£ PMEmo Dataset

**Source**: PMEmo 2019 (Music Emotion Recognition with EDA Signals)  
**Link**: https://github.com/HuiZhangDB/PMEmo

**Steps:**
1. Clone the repository:
   ```bash
   git clone https://github.com/HuiZhangDB/PMEmo.git
   ```
2. Download `PMEmo2019.zip` from the repository releases
3. Extract to:
   ```
   Semester1/data/PMEmo2019/PMEmo2019/
   ```

**Expected structure:**
```
PMEmo2019/PMEmo2019/
â”œâ”€â”€ chorus/                        # 794 MP3 files (30s chorus segments)
â”œâ”€â”€ annotations/                   # Static annotations
â”‚   â””â”€â”€ static_annotations.csv
â””â”€â”€ annotations_time_continuous/   # Dynamic annotations (0.5s windows)
    â””â”€â”€ *.csv (794 files)
```

**Verification:**
```bash
cd Semester1
python notebooks/06_quick_test.py
```

---

## ðŸ“Š Dataset Statistics

| Dataset | Songs/Clips | Total Duration | Annotation Type | Annotation Method | File Format |
|---------|-------------|----------------|-----------------|-------------------|-------------|
| **DEAM** | 1,802 | ~120 hours | Static + Dynamic | Crowd-sourced (MTurk) | MP3 (VBR) |
| **MuSe** | 90,001 | ~750 hours | Dynamic (1s windows) | Expert annotations | MP3 (128 kbps) |
| **PMEmo** | 794 | ~7 hours | Static + Dynamic (0.5s) | Crowd-sourced + EDA signals | MP3 (192 kbps) |

### Annotation Details

#### DEAM
- **Valence Range**: [1, 9] (discrete scale)
- **Arousal Range**: [1, 9] (discrete scale)
- **Annotators per song**: 10-20 (crowd-sourced)
- **Sampling Rate**: 45-second annotations

#### MuSe
- **Valence Range**: [-1, 1] (continuous)
- **Arousal Range**: [-1, 1] (continuous)
- **Annotators**: Expert musicians
- **Sampling Rate**: 1-second windows

#### PMEmo
- **Valence Range**: [1, 9] (discrete scale)
- **Arousal Range**: [1, 9] (discrete scale)
- **Annotators per song**: 457 participants (crowd-sourced)
- **Additional Signals**: EDA (Electrodermal Activity)
- **Sampling Rate**: 0.5-second windows (dynamic)

---

## ðŸ”§ Feature Extraction

### Automatic Extraction via Notebooks

Features are automatically extracted when you run the notebooks:

1. **DEAM**: `notebooks/02_feature_extraction.ipynb`
   - Output: `data/DEAM/processed/deam_features.csv`
   - Dimensions: 1,802 songs Ã— 334 features

2. **MuSe**: `notebooks/05_muse_feature_extraction.ipynb`
   - Output: `data/MuSe/processed/muse_features_133dim.csv`
   - Dimensions: 90,001 clips Ã— 133 features

3. **PMEmo**: `notebooks/06_pmemo_baseline_models.ipynb`
   - Output: `data/PMEmo2019/processed/pmemo_features_rich.csv`
   - Dimensions: 794 songs Ã— 334 features

### Manual Batch Extraction

```bash
# Extract all features at once (takes ~2-3 hours)
python scripts/extract_all_features.py --dataset all

# Extract specific dataset
python scripts/extract_all_features.py --dataset pmemo
```

---

## ðŸš¨ Important Notes

### Data Privacy & Copyright

- **DEAM**: Academic use only, requires request form
- **MuSe**: CC BY 4.0 license
- **PMEmo**: Research purposes only

**âš ï¸ Do NOT redistribute raw audio files without permission!**

---

### File Sizes

**Before feature extraction:**
- DEAM: ~3 GB
- MuSe: ~2 GB (partial), ~15 GB (full via Spotify)
- PMEmo: ~1.5 GB
- **Total**: ~6.5 GB (minimal) or ~19.5 GB (full)

**After feature extraction:**
- DEAM: +180 MB (features)
- MuSe: +450 MB (features)
- PMEmo: +30 MB (features)
- **Total**: +660 MB

**ðŸ’¡ Recommendation**: Use an external drive for datasets (D:\ or E:\)

---

## ðŸ› Troubleshooting

### Issue 1: Audio Files Not Found

**Error**: `FileNotFoundError: No such file or directory: 'data/DEAM/DEAM_audio/...'`

**Solution**:
1. Verify directory structure matches above
2. Check file permissions
3. Run verification script:
   ```bash
   python verify_deam.py
   ```

---

### Issue 2: Feature Extraction Too Slow

**Problem**: Feature extraction takes >4 hours

**Solution**:
1. Use batch extraction with multiprocessing:
   ```bash
   python scripts/extract_all_features.py --n_jobs 4
   ```
2. Extract only a subset for testing:
   ```python
   # In notebook, limit to first 100 songs
   df = df.head(100)
   ```

---

### Issue 3: Out of Memory

**Error**: `MemoryError` during feature extraction

**Solution**:
1. Process in smaller batches (50 songs at a time)
2. Close other applications
3. Increase system virtual memory (Windows) or swap (Linux)

---

## ðŸ“š References

### Dataset Papers

1. **DEAM**:
   - Aljanaki, A., Yang, Y. H., & Soleymani, M. (2017). "Developing a benchmark for emotional analysis of music." *PloS one*, 12(3), e0173392.

2. **MuSe**:
   - Deng, J., Xu, X., Zhang, Z., FrÃ¼hholz, S., & Schuller, B. (2021). "Universum prescription: Regularization using unlabeled data." *ICASSP 2021*.

3. **PMEmo**:
   - Zhang, K., Zhang, H., Li, S., Yang, C., & Sun, L. (2018). "The PMEmo dataset for music emotion recognition." *ICMR 2018*.

---

## ðŸ”— Quick Links

- [DEAM Dataset Homepage](https://cvml.unige.ch/databases/DEAM/)
- [MuSe Challenge Homepage](https://www.muse-challenge.org/)
- [PMEmo GitHub Repository](https://github.com/HuiZhangDB/PMEmo)

---

**Last Updated**: 2025-12-03

